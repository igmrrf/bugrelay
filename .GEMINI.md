
> This document provides context and guidelines for AI assistants working with the BugRelay codebase.

## Project Overview

**BugRelay** is a modern, scalable public bug tracking platform that bridges the gap between users who discover bugs and companies who need to fix them. Users can report bugs in any application, and companies can claim ownership and manage bug reports.

### Key Characteristics
- **Type**: Full-stack web application
- **Stage**: MVP in active development
- **Architecture**: Microservices with Docker containerization
- **Primary Use Case**: Public bug tracking and company-user collaboration

## Technology Stack

### Frontend
- **Framework**: Next.js 15 (React with App Router)
- **Language**: TypeScript
- **Styling**: TailwindCSS + Shadcn/UI
- **State Management**: Zustand / TanStack Query
- **Port**: 3000 (dev), served via Nginx (prod)

### Backend
- **Language**: Go 1.25.3
- **Framework**: Gin (HTTP web framework)
- **ORM**: GORM
- **Port**: 8080
- **Key Libraries**:
  - `github.com/gin-gonic/gin` - HTTP routing
  - `gorm.io/gorm` - Database ORM
  - `github.com/golang-jwt/jwt/v5` - JWT authentication
  - `github.com/redis/go-redis/v9` - Redis client
  - `golang.org/x/oauth2` - OAuth integration

### Infrastructure
- **Database**: PostgreSQL 17.0
- **Cache**: Redis 7.4.1
- **Reverse Proxy**: Nginx (production)
- **Containerization**: Docker + Docker Compose
- **Monitoring Stack**:
  - Prometheus (metrics)
  - Grafana (visualization)
  - Loki (log aggregation)
  - Promtail (log collection)
  - AlertManager (alerting)

### Documentation
- **Framework**: VitePress
- **Port**: 3001 (dev)
- **Features**: Auto-generated API docs from Go codebase

## Project Structure

```
bugrelay/
â”œâ”€â”€ backend/              # Go backend service
â”‚   â”œâ”€â”€ cmd/             # Command-line tools
â”‚   â”œâ”€â”€ internal/        # Private application code
â”‚   â”‚   â”œâ”€â”€ config/      # Configuration management
â”‚   â”‚   â”œâ”€â”€ database/    # Database models and connections
â”‚   â”‚   â”œâ”€â”€ handlers/    # HTTP request handlers
â”‚   â”‚   â”œâ”€â”€ middleware/  # HTTP middleware
â”‚   â”‚   â”œâ”€â”€ redis/       # Redis client setup
â”‚   â”‚   â”œâ”€â”€ router/      # Route definitions
â”‚   â”‚   â”œâ”€â”€ services/    # Business logic
â”‚   â”‚   â””â”€â”€ utils/       # Utility functions
â”‚   â”œâ”€â”€ migrations/      # SQL migration files
â”‚   â”œâ”€â”€ logs/           # Application logs
â”‚   â”œâ”€â”€ main.go         # Application entry point
â”‚   â”œâ”€â”€ go.mod          # Go dependencies
â”‚   â””â”€â”€ Dockerfile      # Multi-stage Docker build
â”‚
â”œâ”€â”€ frontend/            # Next.js frontend application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/        # Next.js 13+ app directory
â”‚   â”‚   â”œâ”€â”€ components/ # React components
â”‚   â”‚   â”œâ”€â”€ hooks/      # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ lib/        # Utility functions
â”‚   â”‚   â”œâ”€â”€ store/      # Zustand state stores
â”‚   â”‚   â””â”€â”€ types/      # TypeScript definitions
â”‚   â”œâ”€â”€ public/         # Static assets
â”‚   â””â”€â”€ Dockerfile      # Multi-stage Docker build
â”‚
â”œâ”€â”€ docs/                # VitePress documentation
â”‚   â”œâ”€â”€ .vitepress/     # VitePress configuration
â”‚   â”œâ”€â”€ api/            # API reference docs
â”‚   â”œâ”€â”€ authentication/ # Auth guides
â”‚   â”œâ”€â”€ deployment/     # Deployment guides
â”‚   â”œâ”€â”€ guides/         # Tutorials
â”‚   â”œâ”€â”€ models/         # Data model docs
â”‚   â”œâ”€â”€ mcp/            # AI integration docs
â”‚   â””â”€â”€ scripts/        # Doc generation scripts
â”‚
â”œâ”€â”€ monitoring/          # Monitoring configuration
â”‚   â”œâ”€â”€ grafana/        # Grafana dashboards
â”‚   â”œâ”€â”€ prometheus/     # Prometheus config
â”‚   â”œâ”€â”€ loki/          # Loki config
â”‚   â”œâ”€â”€ promtail/      # Promtail config
â”‚   â””â”€â”€ alertmanager/  # AlertManager config
â”‚
â”œâ”€â”€ nginx/              # Nginx configuration
â”œâ”€â”€ scripts/            # Utility scripts
â”œâ”€â”€ docker-compose.yml  # Service orchestration
â””â”€â”€ .env               # Environment variables
```

## Development Workflow

### Starting the Development Environment

```bash
# Using Docker (recommended)
docker-compose --profile dev up -d

# Or using Make
make dev

# Access services:
# - Frontend: http://localhost:3000
# - Backend: http://localhost:8080
# - Docs: http://localhost:3001
# - Grafana: http://localhost:3001 (monitoring)
# - Prometheus: http://localhost:9090
```

### Common Commands

```bash
# Setup
make setup              # Install all dependencies

# Development
make dev                # Start dev environment
make logs               # View logs
make shell              # Access backend shell

# Database
make migrate            # Run migrations
make seed               # Seed test data

# Testing
make test               # Run all tests
npm run test:frontend   # Frontend tests only
npm run test:backend    # Backend tests only

# Documentation
make docs               # Start docs server
npm run docs:generate   # Regenerate API docs
npm run docs:validate   # Validate docs

# Cleanup
make stop               # Stop services
make clean              # Remove containers and volumes
```

## Key Features & Implementation Status

### âœ… Production Ready
- Documentation system with auto-generation
- Docker-based development environment
- Monitoring and observability stack
- Project structure and build system

### ðŸ”„ In Active Development
- JWT authentication with OAuth (Google, GitHub)
- Bug submission and management
- Company verification system
- User management and permissions
- Comments and voting system

### ðŸ“‹ Planned
- Advanced search and filtering
- Email notifications
- Webhooks for integrations
- Analytics dashboard
- Mobile applications

## API Structure

### Base URL
- Development: `http://localhost:8080/api/v1`
- Production: Configured via `NEXT_PUBLIC_API_URL`

### Key Endpoints (Planned/In Development)

```
POST   /api/v1/bugs              # Submit new bug
GET    /api/v1/bugs              # List bugs
GET    /api/v1/bugs/:id          # Get bug details
PATCH  /api/v1/bugs/:id/status   # Update bug status (company only)

GET    /api/v1/companies         # List companies
POST   /api/v1/companies/:id/claim    # Claim company
POST   /api/v1/companies/:id/verify   # Verify claim

POST   /api/v1/auth/register     # User registration
POST   /api/v1/auth/login        # User login
POST   /api/v1/auth/oauth/google # Google OAuth
POST   /api/v1/auth/oauth/github # GitHub OAuth

GET    /health                   # Health check
```

## Environment Variables

### Required for Development
```bash
# Database
DB_HOST=postgres
DB_PORT=5432
DB_NAME=bugrelay
DB_USER=bugrelay_user
DB_PASSWORD=bugrelay_password

# Redis
REDIS_HOST=redis
REDIS_PORT=6379

# JWT
JWT_SECRET=dev-jwt-secret-key

# Environment
ENVIRONMENT=development
```

### Required for Production
```bash
# All development vars plus:
JWT_SECRET=<strong-random-secret>
GOOGLE_CLIENT_ID=<google-oauth-client-id>
GOOGLE_CLIENT_SECRET=<google-oauth-secret>
GITHUB_CLIENT_ID=<github-oauth-client-id>
GITHUB_CLIENT_SECRET=<github-oauth-secret>
RECAPTCHA_SECRET_KEY=<recaptcha-secret>
NEXT_PUBLIC_RECAPTCHA_SITE_KEY=<recaptcha-site-key>
```

## Code Style & Conventions

### Go Backend
- Follow standard Go conventions (gofmt, golint)
- Use GORM for database operations
- Organize code by feature in `internal/`
- Use middleware for cross-cutting concerns
- Error handling: return errors, don't panic
- Logging: use structured logging (JSON format)

### TypeScript Frontend
- Use TypeScript strict mode
- Functional components with hooks
- Organize by feature in `src/app/`
- Use Zustand for global state
- TanStack Query for server state
- Follow Next.js 13+ conventions (app router)

### Database
- Use migrations for schema changes
- Place migrations in `backend/migrations/`
- Name format: `YYYYMMDDHHMMSS_description.sql`
- Always provide up and down migrations

## Testing Strategy

### Backend Testing
- Unit tests: `*_test.go` files alongside code
- Integration tests: `internal/tests/`
- Run: `go test ./...`

### Frontend Testing
- Component tests: `*.test.tsx`
- Integration tests: `__tests__/` directories
- Run: `npm test` in frontend directory

### Documentation Testing
- Validation: `npm run validate` in docs directory
- Comprehensive tests: `npm run test:comprehensive`

## Docker Profiles

The project uses Docker Compose profiles for different environments:

### Development Profile (`dev`)
```bash
docker-compose --profile dev up
```
Includes:
- PostgreSQL, Redis
- Backend with hot reload
- Frontend with hot reload
- MailHog (email testing)
- Full monitoring stack (Grafana, Prometheus, Loki, etc.)

### Production Profile (`prod`)
```bash
docker-compose --profile prod up
```
Includes:
- PostgreSQL, Redis
- Backend (optimized build)
- Frontend (optimized build)
- Nginx reverse proxy
- Monitoring stack
- Backup service

## Common Development Tasks

### Adding a New API Endpoint

1. **Define the route** in `backend/internal/router/router.go`
2. **Create handler** in `backend/internal/handlers/`
3. **Add business logic** in `backend/internal/services/`
4. **Update database models** if needed in `backend/internal/database/models/`
5. **Add migration** if schema changes in `backend/migrations/`
6. **Document** in `docs/api/` (or regenerate with `npm run generate:all`)

### Adding a New Frontend Page

1. **Create page** in `frontend/src/app/[route]/page.tsx`
2. **Add components** in `frontend/src/components/`
3. **Create hooks** if needed in `frontend/src/hooks/`
4. **Add types** in `frontend/src/types/`
5. **Update navigation** if needed

### Database Migration

1. **Create migration file**: `backend/migrations/YYYYMMDDHHMMSS_description.sql`
2. **Write SQL** for schema changes
3. **Run migration**: `make migrate` or restart backend
4. **Update GORM models** in `backend/internal/database/models/`

## Debugging

### Backend Debugging
- Logs: `docker-compose logs backend` or `make logs`
- Shell access: `make shell`
- Debugger port: 2345 (Delve)

### Frontend Debugging
- Logs: `docker-compose logs frontend`
- Browser DevTools for client-side
- Next.js error overlay in development

### Database Debugging
- Connect: `docker exec -it bugrelay-postgres psql -U bugrelay_user -d bugrelay`
- View logs: `docker-compose logs postgres`

### Monitoring
- Grafana: http://localhost:3001 (dev profile)
- Prometheus: http://localhost:9090
- Loki logs: via Grafana

## Security Considerations

- JWT tokens for authentication
- OAuth integration for social login
- reCAPTCHA for spam prevention
- Rate limiting on API endpoints
- SQL injection prevention via GORM
- CORS configuration in backend
- Environment variables for secrets
- HTTPS in production (via Nginx)

## Performance Optimization

- Redis caching for frequently accessed data
- Database indexing on common queries
- Next.js static generation where possible
- Image optimization via Next.js
- Gzip compression via Nginx
- Connection pooling for database

## Documentation

The project uses VitePress for comprehensive documentation:

- **Location**: `docs/` directory
- **Dev server**: `npm run dev` in docs/
- **Build**: `npm run build` in docs/
- **Auto-generation**: API docs generated from Go code
- **Access**: http://localhost:3001 (when running)

## Contributing Guidelines

See [CONTRIBUTING.md](CONTRIBUTING.md) for detailed guidelines on:
- Code standards
- Pull request process
- Testing requirements
- Documentation updates

## Deployment

See [DEPLOYMENT.md](DEPLOYMENT.md) for production deployment instructions.

## AI Assistant Guidelines

When helping with this project:

1. **Respect the architecture**: Don't suggest major architectural changes without discussion
2. **Follow conventions**: Use existing patterns for new code
3. **Test your suggestions**: Ensure code compiles and follows project standards
4. **Update documentation**: Suggest doc updates for new features
5. **Consider both environments**: Code should work in dev and prod
6. **Security first**: Always consider security implications
7. **Use existing tools**: Leverage Make commands and npm scripts
8. **Check dependencies**: Ensure new dependencies are necessary and well-maintained

## Useful Resources

- [Go Documentation](https://golang.org/doc/)
- [Gin Framework](https://gin-gonic.com/docs/)
- [Next.js Documentation](https://nextjs.org/docs)
- [GORM Documentation](https://gorm.io/docs/)
- [Docker Compose](https://docs.docker.com/compose/)
- [VitePress](https://vitepress.dev/)

## Support & Questions

- **Documentation**: Start with `docs/guides/quick-start.md`
- **Issues**: Use GitHub Issues
- **Discussions**: Use GitHub Discussions

---

**Last Updated**: December 2025
**Project Status**: MVP in Active Development
**License**: MIT
